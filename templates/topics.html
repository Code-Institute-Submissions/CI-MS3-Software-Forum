<!DOCTYPE html>
{% extends 'base.html'%}
{% block content %}
<section id="home-section">
    <div class="container">
    <h1>We help you achieve your goal. Choose the right software for your purpose.</h1>
    <h3>Create a new topic if you want tips for a certain task. Or use the search function to check if someone else
        has a similar request.
        Write a comment if you can contribute to someones topic. If the topic has been edited after a comment was
        placed, the comment is marked 'expired'.
    </h3>
    <div class="filteroptions-wrapper">
    <div class="row">
        <div class="col m6">
        <div class="col s12 m6">
            Enter a search keyword:
        </div>
        <div class="input-field search-field col s12 m6">
            <input placeholder="Search" type="search" class="validate" id="searchfield">
        </div>
        </div>
        <div class="col m6">
        <div class="col s12 m6">
            Search scope
        </div>
        <div id="search-options" class="col s12 m6">
            <select multiple id="search-scope">
                <option value="title" selected>Titles</option>
                <option value="details" selected>Details</option>
                <option value="comments.comment_text" selected>Comments</option>
            </select>
        </div>
        </div>
    </div>
    <ul class="collapsible">
        <li>
            <div class="collapsible-header"><i class="fas fa-caret-down"></i>Click here to choose more
                filters to sort and search your results
            </div>
            <div class="collapsible-body">
                <div class="row">
                    <div class="col s12 m6">
                        Sort publish date
                    </div>
                    <div id="search-options" class="col s12 m6">
                        <div class="input-field">
                            <select id="sortdate">
                                <option value="-1" selected>Descending</option>
                                <option value="1">Ascending</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12 m6">
                        Select your preferred platform
                    </div>
                    <div id="search-options" class="col s12 m6">
                        <div class="input-field">
                            <select multiple id="platformfilter">
                                <option value="Windows" selected>Windows</option>
                                <option value="MacOS" selected>MacOS</option>
                                <option value="Linux" selected>Linux</option>
                                <option value="Android" selected>Android</option>
                                <option value="iOS" selected>iOS</option>
                                <option value="Other" selected>Other</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12 m6">
                        Filter cost
                    </div>
                    <div id="search-options" class="col s12 m6">
                        <div class="input-field">
                            <select id="costfilter">
                                <option value="All" selected>All</option>
                                <option value="Free">Free</option>
                                <option value="Paid">Paid</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col s12 m6">
                        Commented yes or no
                    </div>
                    <div id="search-options" class="col s12 m6">
                        <div class="input-field">
                            <select id="answersfilter">
                                <option value="All" selected>All</option>
                                <option value="Answered">Answered</option>
                                <option value="Unanswered">Unanswered</option>
                            </select>
                        </div>
                    </div>
                </div>
        </li>
    </ul>
    </div>
    </div>
    <!-- modal for defensive programming-->
    <div id="noselection-modal" class="modal">
    <div class="modal-content">
      <h4>Alert</h4>
      <p>Please select at least 1 option</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">OK</a>
    </div>
</div>
<div id="maxlength40-modal" class="modal">
    <div class="modal-content">
      <h4>Alert</h4>
      <p>Don't enter more than 40 characters</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">OK</a>
    </div>
</div>
</section>
<section id="topics-section">
<div class="container">
<h2>Topics</h2>
    <div id="progress-wrapper">
        <div class="progress hide-progress" id="dbupdate-progress">
            <div class="indeterminate"></div>
        </div>
    </div>
    <div id="topics-header">
        <!-- table header -->
        
            <div class="row">
                <div class="col s12 l6">
                    <h4>Title</h4>
                </div>
                <div class="col s4 l2">
                    <h4>Published</h4>
                </div>
                <div class="col s4 l2 hidden-options">
                    <h4>Platform</h4>
                </div>
                <div class="col s2 l1">
                    <h4>Cost</h4>
                </div>
                <div class="col s2 l1">
                    <h4>Answers</h4>
                </div>
            </div>
        
        <!-- creating the table with the data from the database -->
        <div id="topics-table">
            <ul class="collapsible" data-collapsible="accordion">
                {% for topic in topics %}
                <li>
                    <div class="collapsible-header">
                        <div class="row">
                            <div class="col s12 l6">
                                <h5><i class="fas fa-caret-down"></i>{{ topic.title }}</h5>
                            </div>
                            <div class="col s4 l2">
                                {{ topic.publish_date.strftime('%d-%m-%Y') }}
                            </div>
                            <div class="col s4 l2">
                                {% for getos in topic.os %}
                                {{ getos }}
                                {% if not loop.last %}
                                ,
                                {% endif %}
                                {% endfor %}
                            </div>
                            <div class="col s2 l1">
                                {{ topic.cost }}
                            </div>
                            <div class="col s2 l1">
                                <div>{{ topic.comments|length }}</div>
                            </div>
                        </div>
                    </div>
                    <!-- collapsible body -->
                    <div class="collapsible-body">
                                            <div class="row">
                            <div class="col s12">
                                <h5>Details:</h5>
                            </div>
                        </div>
                        <div class="row">
                            <div class="comment-wrapper">
                                <p>{{ topic.details }}</p>
                                <p class="right-align topic-author"><em>{{ topic.author }}</em></p>
                            </div>
                            <div class="topic-btn-wrapper">
                                <a href="{{ url_for('delete_topic', topic_id=topic._id) }}"
                                    class="topic-action"><i class="material-icons">delete</i>Delete Topic</a>
                                <a href="{{ url_for('edit_topic', topic_id=topic._id) }}"
                                    class="topic-action"><i class="material-icons">edit</i>Edit Topic</a>
                            </div>
                        </div>
                        <!-- Display the comment(s) -->
                        <div class="row">
                            <div class="col s12">
                                <h5>Comments:</h5>
                            </div>
                        </div>
                        {% for object in topic.comments %}
                        <div class="row">
                            <div class="comment-wrapper">
                                <div class="comment-text">
                                    {% if object.expired %}
                                    <p><span class="em-red">Expired: </span>{{ object.comment_text }}</p>
                                    {% else %}
                                    <p>{{ object.comment_text }}</p>
                                    {% endif %}
                                    <p class="right-align"><em>{{ object.comment_author }}</em></p>
                                </div>
                            </div>
                            <div class="thumbs-field">
                                <div class="thumb-up" topic_id="{{ topic._id }}" loop_index="{{ loop.index }}">
                                    <i class="fas fa-thumbs-up"></i>
                                </div>
                                <p>{{ object.comment_pos }}</p>
                                <div class="thumb-down" topic_id="{{ topic._id }}" loop_index="{{ loop.index }}">
                                    <i class="fas fa-thumbs-down"></i>
                                </div>
                                <p>{{ object.comment_neg }}</p>
                            </div>
                        </div>
                        {% endfor %}
                        <!-- Input form for comments/answers -->
                        <form action="{{ url_for('insert_comment', topic_id=topic._id) }}" method="POST">
                            <div class="comment-form">
                                <div class="row">
                                    <div class="input-field col s12">
                                        <i class="material-icons prefix">edit</i>
                                        <textarea id="comment-input" class="materialize-textarea"></textarea>
                                        <label for="comment-input">Write your comment here</label>
                                    </div>
                                    <div class="input-field col s12">
                                        <i class="material-icons prefix">account_circle</i>
				                        <input id="comment-author" type="text" class="validate" name="comment_author">
				                        <label for="comment-author">Your name</label>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <button class="btn cancel-comment" type="button">Cancel              
                                </button>
                                <button class="btn submit-comment" name="action">Submit             
                                </button>
                                <button class="btn add-comment" type="button">New comment              
                                </button>
                            </div>
                        </form>
                    </div>
                </li>
                {% endfor %}
            </ul>
            Displaying {{ args.p_limit }} of {{ args.num_results }} topics in total
            <!-- pagination -->
            {% if args.num_results > args.p_limit %}
            <ul class="pagination">
                {% if args.p_offset > 0 %}
                <li class="waves-effect"><a href="{{args.prev_url}}"><i class="material-icons">chevron_left</i></a></li>
                {% else %}
                <li class="disabled"><a href=""><i class="material-icons">chevron_left</i></a></li>
                {% endif %}
                {% for page in range (1, args.num_pages) %}
                {% if args.active_page == page %}
                <li class="active"><a href="">{{ page }}</a></li>
                {% else %}
                <li class="waves-effect"><a href="#!">{{ page }}</a></li>
                {% endif %}
                {% endfor %}
                {% if args.p_offset + args.p_limit < args.num_results  %}
                <li class="waves-effect"><a href="{{args.next_url}}"><i class="material-icons">chevron_right</i></a>
                </li>
                {% else %}
                <li class="disabled"><a href=""><i class="material-icons">chevron_right</i></a></li>
                {% endif %}
            </ul>
            {% endif %}
        </div>
    </div>
    </div>
</section>
<section id="addtopic-section">
<div class="container">
    <h2 class="white-text">Add a new topic</h2>

<div class="inputform-wrapper">
<div class="row">
	<form action="{{ url_for('insert_topic') }}" method="POST" class="col s12">
		<div class="row">
			<div class="input-field col s12 m6">
            <i class="material-icons prefix">announcement</i>
				<input id="title" type="text" class="validate" name="title">
				<label for="title">topic title</label>
			</div>
		    <div class="input-field col s12 m6">
                <i class="material-icons prefix">account_circle</i>
				<input id="author" type="text" class="validate" name="author">
				<label for="author">Your name</label>
			</div>
			
		</div>
		<div class="row">
        <div class="input-field col s12">
                <i class="material-icons prefix">edit</i>
				
                <textarea id="description" name="details"></textarea>
				<label for="description">Detail description of what you want to achieve</label>
			</div>
			
		</div>
		<div class="row">
			<div class="col s12 m6 platform-select">
				<h4>Select one or more platforms</h4>
                <div class="platform-select">
				<label>
                    <input type="checkbox" class="filled-in" name="os" value="Windows"/>
                    <span><div class="platform-icons"><i class="fab fa-windows"></i></div>Windows</span>
                </label>
                </div>
				<div class="platform-select">
				<label>
                    <input type="checkbox" class="filled-in" name="os" value="MacOS"/>
                    <span><div class="platform-icons"><span><i class="fab fa-apple"></i></div>MacOS</span>
                </label>
                </div>
				<div class="platform-select">
				<label>
                    <input type="checkbox" class="filled-in" name="os" value="Linux"/>
                    <span><div class="platform-icons"><span><i class="fab fa-linux"></i></div>Linux</span>
                </label>
                </div>
				<div class="platform-select">
				<label>
                    <input type="checkbox" class="filled-in" name="os" value="Android"/>
                    <span><div class="platform-icons"><i class="fab fa-android"></i></div>Android</span>
                </label>
                </div>
				<div class="platform-select">
				<label>
                    <input type="checkbox" class="filled-in" name="os" value="iOS"/>
                    <span><div class="platform-icons"><i class="fas fa-mobile-alt"></i></div>iOS</span>
                </label>
				</div>
                <div class="platform-select">
				<label>
                    <input type="checkbox" class="filled-in" name="os" value="Other"/>
                    <span><div class="platform-icons"><i class="fas fa-desktop"></i></div>Other</span>
                </label>
                </div>
			</div>
			<div class="col s12 m6">
				<h4>Purchase or subscription costs </h4>
                <div class="platform-select">
				<label>
                    <input type="radio" name="cost" value="Any" checked>
                    <span>Any</span>
                </label>
                </div>
				<div class="platform-select">
				<label>
                    <input type="radio" name="cost" value="Free"/>
                    <span>Free</span>
                </label>
                </div>
				<div class="platform-select">
				<label>
                    <input type="radio" name="cost" value="Paid"/>
                    <span>Paid</span>
                </label>
                </div>
			</div>
		</div>

		<div class="row">
        <div class="save-btn-wrapper">
			<button class="btn blue darken-2" type="submit" name="action"><i class="fas fa-file-download"></i>Save</button>
            </div>
		</div>
	</form>
    </div>
</div>
<div class="container">
</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
{% endblock %}